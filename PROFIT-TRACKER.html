<!DOCTYPE html>
<html>
<head>
    <title>üí∞ Profit Tracker & Analytics Dashboard</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0e1f;
            color: #e2e8f0;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        .header {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(245, 158, 11, 0.3);
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: #1e293b;
            border: 2px solid #334155;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s;
        }
        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }
        .stat-card.profit {
            border-color: #10b981;
            background: linear-gradient(135deg, #065f46 0%, #047857 100%);
        }
        .stat-card.loss {
            border-color: #ef4444;
            background: linear-gradient(135deg, #7f1d1d 0%, #dc2626 100%);
        }
        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #f59e0b;
            margin-bottom: 5px;
        }
        .stat-label {
            color: #94a3b8;
            font-size: 0.9em;
        }
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }
        .card {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 15px;
            padding: 25px;
        }
        .card-title {
            font-size: 1.3em;
            color: #f59e0b;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .input-group {
            margin: 15px 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            color: #94a3b8;
            font-weight: 500;
        }
        input, select, textarea {
            width: 100%;
            padding: 12px;
            background: #334155;
            border: 2px solid #475569;
            border-radius: 8px;
            color: white;
            font-size: 1em;
            box-sizing: border-box;
        }
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #f59e0b;
        }
        button {
            background: #f59e0b;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        button:hover {
            background: #d97706;
            transform: translateY(-2px);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #334155;
        }
        th {
            background: #0f172a;
            color: #f59e0b;
            font-weight: 600;
        }
        tr:hover {
            background: #2d3748;
        }
        .profit-cell {
            color: #10b981;
            font-weight: bold;
        }
        .loss-cell {
            color: #ef4444;
            font-weight: bold;
        }
        .chart-container {
            background: #0f172a;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            height: 300px;
            position: relative;
        }
        .chart-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #64748b;
            font-size: 1.1em;
        }
        .trade-form {
            background: #0f172a;
            border: 2px solid #f59e0b;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
        .success-message {
            background: #10b981;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
        }
        .error-message {
            background: #ef4444;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
        }
        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .filter-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .filter-item label {
            font-size: 0.9em;
            margin-bottom: 2px;
        }
        .filter-item input, .filter-item select {
            padding: 8px;
            font-size: 0.9em;
            width: 150px;
        }
        .export-section {
            background: #334155;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
        }
        .badge.profit {
            background: #10b981;
            color: white;
        }
        .badge.loss {
            background: #ef4444;
            color: white;
        }
        .badge.pending {
            background: #f59e0b;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí∞ Profit Tracker & Analytics</h1>
            <p>Track your USDT arbitrage trading performance and optimize your strategy</p>
        </div>

        <div class="stats-grid">
            <div class="stat-card profit">
                <div class="stat-value" id="totalProfit">‚Çπ0</div>
                <div class="stat-label">Total Profit</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalTrades">0</div>
                <div class="stat-label">Total Trades</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="avgProfit">0%</div>
                <div class="stat-label">Average ROI</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="winRate">0%</div>
                <div class="stat-label">Win Rate</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="bestTrade">‚Çπ0</div>
                <div class="stat-label">Best Trade</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalVolume">‚Çπ0</div>
                <div class="stat-label">Total Volume</div>
            </div>
        </div>

        <div class="main-grid">
            <div class="card">
                <div class="card-title">üìä Performance Chart</div>
                <div class="chart-container">
                    <canvas id="profitChart" width="400" height="200"></canvas>
                    <div class="chart-placeholder" id="chartPlaceholder">
                        üìà Chart will appear here after recording trades
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-title">üéØ Quick Stats</div>
                <table>
                    <tr>
                        <td>Today's Profit</td>
                        <td class="profit-cell" id="todayProfit">‚Çπ0</td>
                    </tr>
                    <tr>
                        <td>This Week</td>
                        <td class="profit-cell" id="weekProfit">‚Çπ0</td>
                    </tr>
                    <tr>
                        <td>This Month</td>
                        <td class="profit-cell" id="monthProfit">‚Çπ0</td>
                    </tr>
                    <tr>
                        <td>TDS Saved</td>
                        <td class="profit-cell" id="tdsSaved">‚Çπ0</td>
                    </tr>
                    <tr>
                        <td>Tax Paid (30%)</td>
                        <td class="loss-cell" id="taxPaid">‚Çπ0</td>
                    </tr>
                    <tr>
                        <td>Net After Tax</td>
                        <td class="profit-cell" id="netAfterTax">‚Çπ0</td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="trade-form">
            <h2 style="color: #f59e0b; margin-bottom: 20px;">‚ûï Record New Trade</h2>
            
            <div class="form-grid">
                <div>
                    <div class="input-group">
                        <label>Buy Exchange</label>
                        <select id="buyExchange">
                            <option value="CoinDCX">CoinDCX</option>
                            <option value="WazirX">WazirX</option>
                            <option value="Giottus">Giottus</option>
                            <option value="CoinSwitch">CoinSwitch</option>
                            <option value="ZebPay">ZebPay</option>
                            <option value="Bitbns">Bitbns</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>Buy Price (‚Çπ)</label>
                        <input type="number" id="buyPrice" placeholder="87.20" step="0.01">
                    </div>
                    <div class="input-group">
                        <label>Buy Amount (‚Çπ)</label>
                        <input type="number" id="buyAmount" placeholder="49000">
                    </div>
                </div>
                <div>
                    <div class="input-group">
                        <label>Sell Platform</label>
                        <select id="sellPlatform">
                            <option value="Binance P2P">Binance P2P</option>
                            <option value="WazirX P2P">WazirX P2P</option>
                            <option value="CoinDCX P2P">CoinDCX P2P</option>
                            <option value="ZebPay P2P">ZebPay P2P</option>
                            <option value="Local P2P">Local P2P</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>Sell Price (‚Çπ)</label>
                        <input type="number" id="sellPrice" placeholder="90.00" step="0.01">
                    </div>
                    <div class="input-group">
                        <label>Sell Amount (‚Çπ)</label>
                        <input type="number" id="sellAmount" placeholder="51000">
                    </div>
                </div>
            </div>

            <div class="input-group">
                <label>Notes (Optional)</label>
                <textarea id="tradeNotes" placeholder="Add any notes about this trade..." rows="3"></textarea>
            </div>

            <button onclick="recordTrade()">üíæ Record Trade</button>
            <button onclick="clearForm()">üóëÔ∏è Clear Form</button>

            <div class="success-message" id="successMessage">
                Trade recorded successfully!
            </div>
            <div class="error-message" id="errorMessage">
                Please fill in all required fields.
            </div>
        </div>

        <div class="card">
            <div class="card-title">üìã Trade History</div>
            
            <div class="filters">
                <div class="filter-item">
                    <label>From Date</label>
                    <input type="date" id="fromDate">
                </div>
                <div class="filter-item">
                    <label>To Date</label>
                    <input type="date" id="toDate">
                </div>
                <div class="filter-item">
                    <label>Exchange</label>
                    <select id="filterExchange">
                        <option value="">All Exchanges</option>
                        <option value="CoinDCX">CoinDCX</option>
                        <option value="WazirX">WazirX</option>
                        <option value="Giottus">Giottus</option>
                        <option value="CoinSwitch">CoinSwitch</option>
                        <option value="ZebPay">ZebPay</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label>Platform</label>
                    <select id="filterPlatform">
                        <option value="">All Platforms</option>
                        <option value="Binance P2P">Binance P2P</option>
                        <option value="WazirX P2P">WazirX P2P</option>
                        <option value="CoinDCX P2P">CoinDCX P2P</option>
                        <option value="Local P2P">Local P2P</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label>&nbsp;</label>
                    <button onclick="applyFilters()">üîç Filter</button>
                </div>
            </div>

            <table id="tradesTable">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Route</th>
                        <th>Buy</th>
                        <th>Sell</th>
                        <th>Profit</th>
                        <th>ROI</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="tradesTableBody">
                    <tr>
                        <td colspan="7" style="text-align: center; color: #64748b;">No trades recorded yet</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="export-section">
            <h3 style="color: #f59e0b; margin-bottom: 15px;">üì§ Export Data</h3>
            <button onclick="exportToCSV()">üìä Export to CSV</button>
            <button onclick="exportToJSON()">üìÑ Export to JSON</button>
            <button onclick="generateTaxReport()">üìã Generate Tax Report</button>
            <button onclick="clearAllData()" style="background: #ef4444;">üóëÔ∏è Clear All Data</button>
        </div>
    </div>

    <script>
        // Global state
        let trades = JSON.parse(localStorage.getItem('arbitrageTrades')) || [];
        let stats = {
            totalProfit: 0,
            totalTrades: 0,
            avgProfit: 0,
            winRate: 0,
            bestTrade: 0,
            totalVolume: 0,
            tdsSaved: 0,
            taxPaid: 0,
            netAfterTax: 0
        };

        function recordTrade() {
            const buyExchange = document.getElementById('buyExchange').value;
            const buyPrice = parseFloat(document.getElementById('buyPrice').value);
            const buyAmount = parseFloat(document.getElementById('buyAmount').value);
            const sellPlatform = document.getElementById('sellPlatform').value;
            const sellPrice = parseFloat(document.getElementById('sellPrice').value);
            const sellAmount = parseFloat(document.getElementById('sellAmount').value);
            const notes = document.getElementById('tradeNotes').value;

            if (!buyPrice || !buyAmount || !sellPrice || !sellAmount) {
                showError('Please fill in all required fields.');
                return;
            }

            const usdtAmount = buyAmount / buyPrice;
            const grossProfit = sellAmount - buyAmount;
            const fees = buyAmount * 0.003; // 0.3% total fees
            const netProfit = grossProfit - fees;
            const roi = (netProfit / buyAmount) * 100;

            const trade = {
                id: Date.now(),
                date: new Date().toISOString(),
                buyExchange,
                buyPrice,
                buyAmount,
                sellPlatform,
                sellPrice,
                sellAmount,
                usdtAmount,
                grossProfit,
                fees,
                netProfit,
                roi,
                notes,
                status: 'completed'
            };

            trades.push(trade);
            saveTrades();
            updateStats();
            updateTradesTable();
            clearForm();
            showSuccess('Trade recorded successfully!');
        }

        function saveTrades() {
            localStorage.setItem('arbitrageTrades', JSON.stringify(trades));
        }

        function updateStats() {
            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
            const monthAgo = new Date(today.getTime() - 30 * 24 * 60 * 60 * 1000);

            stats.totalTrades = trades.length;
            stats.totalProfit = trades.reduce((sum, trade) => sum + trade.netProfit, 0);
            stats.totalVolume = trades.reduce((sum, trade) => sum + trade.buyAmount, 0);
            stats.avgProfit = stats.totalTrades > 0 ? stats.totalProfit / stats.totalTrades : 0;
            stats.winRate = stats.totalTrades > 0 ? (trades.filter(t => t.netProfit > 0).length / stats.totalTrades * 100) : 0;
            stats.bestTrade = trades.length > 0 ? Math.max(...trades.map(t => t.netProfit)) : 0;

            // Calculate TDS saved (assuming we split transactions)
            stats.tdsSaved = trades.filter(t => t.sellAmount < 50000).length * 500; // Approx TDS saved per split
            stats.taxPaid = stats.totalProfit * 0.30; // 30% capital gains tax
            stats.netAfterTax = stats.totalProfit - stats.taxPaid;

            // Today's profit
            const todayTrades = trades.filter(t => new Date(t.date) >= today);
            const todayProfit = todayTrades.reduce((sum, trade) => sum + trade.netProfit, 0);

            // Week's profit
            const weekTrades = trades.filter(t => new Date(t.date) >= weekAgo);
            const weekProfit = weekTrades.reduce((sum, trade) => sum + trade.netProfit, 0);

            // Month's profit
            const monthTrades = trades.filter(t => new Date(t.date) >= monthAgo);
            const monthProfit = monthTrades.reduce((sum, trade) => sum + trade.netProfit, 0);

            // Update UI
            document.getElementById('totalProfit').textContent = `‚Çπ${stats.totalProfit.toLocaleString('en-IN')}`;
            document.getElementById('totalTrades').textContent = stats.totalTrades;
            document.getElementById('avgProfit').textContent = `${stats.avgProfit.toFixed(2)}%`;
            document.getElementById('winRate').textContent = `${stats.winRate.toFixed(1)}%`;
            document.getElementById('bestTrade').textContent = `‚Çπ${stats.bestTrade.toLocaleString('en-IN')}`;
            document.getElementById('totalVolume').textContent = `‚Çπ${stats.totalVolume.toLocaleString('en-IN')}`;

            document.getElementById('todayProfit').textContent = `‚Çπ${todayProfit.toLocaleString('en-IN')}`;
            document.getElementById('weekProfit').textContent = `‚Çπ${weekProfit.toLocaleString('en-IN')}`;
            document.getElementById('monthProfit').textContent = `‚Çπ${monthProfit.toLocaleString('en-IN')}`;
            document.getElementById('tdsSaved').textContent = `‚Çπ${stats.tdsSaved.toLocaleString('en-IN')}`;
            document.getElementById('taxPaid').textContent = `‚Çπ${stats.taxPaid.toLocaleString('en-IN')}`;
            document.getElementById('netAfterTax').textContent = `‚Çπ${stats.netAfterTax.toLocaleString('en-IN')}`;
        }

        function updateTradesTable() {
            const tableBody = document.getElementById('tradesTableBody');
            
            if (trades.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #64748b;">No trades recorded yet</td></tr>';
                return;
            }

            tableBody.innerHTML = trades.map(trade => `
                <tr>
                    <td>${new Date(trade.date).toLocaleDateString()}</td>
                    <td>${trade.buyExchange} ‚Üí ${trade.sellPlatform}</td>
                    <td>‚Çπ${trade.buyPrice.toFixed(2)}</td>
                    <td>‚Çπ${trade.sellPrice.toFixed(2)}</td>
                    <td class="${trade.netProfit > 0 ? 'profit-cell' : 'loss-cell'}">
                        ‚Çπ${trade.netProfit.toLocaleString('en-IN')}
                    </td>
                    <td class="${trade.roi > 0 ? 'profit-cell' : 'loss-cell'}">
                        ${trade.roi.toFixed(2)}%
                    </td>
                    <td>
                        <span class="badge ${trade.status === 'completed' ? 'profit' : 'pending'}">
                            ${trade.status}
                        </span>
                    </td>
                </tr>
            `).join('');
        }

        function clearForm() {
            document.getElementById('buyPrice').value = '';
            document.getElementById('buyAmount').value = '';
            document.getElementById('sellPrice').value = '';
            document.getElementById('sellAmount').value = '';
            document.getElementById('tradeNotes').value = '';
        }

        function showSuccess(message) {
            const successDiv = document.getElementById('successMessage');
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            setTimeout(() => {
                successDiv.style.display = 'none';
            }, 3000);
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 3000);
        }

        function applyFilters() {
            // This would filter the trades table based on selected filters
            updateTradesTable();
        }

        function exportToCSV() {
            const csvContent = [
                'Date,Buy Exchange,Buy Price,Buy Amount,Sell Platform,Sell Price,Sell Amount,Net Profit,ROI,Notes',
                ...trades.map(trade => 
                    `${new Date(trade.date).toLocaleDateString()},${trade.buyExchange},${trade.buyPrice},${trade.buyAmount},${trade.sellPlatform},${trade.sellPrice},${trade.sellAmount},${trade.netProfit},${trade.roi},"${trade.notes}"`
                )
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `arbitrage_trades_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function exportToJSON() {
            const jsonContent = JSON.stringify(trades, null, 2);
            const blob = new Blob([jsonContent], { type: 'application/json' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `arbitrage_trades_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function generateTaxReport() {
            const report = {
                totalProfit: stats.totalProfit,
                taxableAmount: stats.totalProfit,
                taxRate: 0.30,
                taxOwed: stats.taxPaid,
                tdsDeducted: 0, // We avoid TDS by splitting transactions
                netTaxLiability: stats.taxPaid,
                trades: trades.map(trade => ({
                    date: trade.date,
                    profit: trade.netProfit,
                    taxableProfit: trade.netProfit
                }))
            };

            const blob = new Blob([JSON.stringify(report, null, 2)], { type: 'application/json' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `tax_report_${new Date().getFullYear()}.json`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function clearAllData() {
            if (confirm('Are you sure you want to clear all trade data? This cannot be undone.')) {
                trades = [];
                localStorage.removeItem('arbitrageTrades');
                updateStats();
                updateTradesTable();
                showSuccess('All data cleared successfully!');
            }
        }

        // Initialize
        window.onload = function() {
            updateStats();
            updateTradesTable();
            
            // Set default dates
            const today = new Date();
            const lastWeek = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
            document.getElementById('fromDate').value = lastWeek.toISOString().split('T')[0];
            document.getElementById('toDate').value = today.toISOString().split('T')[0];
        };
    </script>
</body>
</html>